"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5235],{1391:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>_,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>d,toc:()=>l});var t=s(5893),c=s(1151);const i={sidebar_position:5},r="4.7 \u79fb\u690d USBX \u5b9e\u73b0\u865a\u62df\u4e32\u53e3",d={id:"Modbus-projectOne/chapter5/chapter5.7",title:"4.7 \u79fb\u690d USBX \u5b9e\u73b0\u865a\u62df\u4e32\u53e3",description:"\u672c\u8282\u7a0b\u5e8f\u6e90\u7801\u4e3a\u201c3\u7a0b\u5e8f\u6e90\u780101\u89c6\u9891\u914d\u5957\u7684\u6e90\u7801 4-7\u79fb\u690d USBX \u5b9e\u73b0\u865a\u62df\u4e32\u53e3 uartusb.7z\u201d\uff0c\u5728\u4e0a\u4e00\u8282\u4ee3\u7801 uart_rtos.7z \u7684\u57fa\u7840\u4e0a\u4fee\u6539\u5f97\u6765\u3002",source:"@site/docs/Modbus-projectOne/chapter5/chapter5.7.md",sourceDirName:"Modbus-projectOne/chapter5",slug:"/Modbus-projectOne/chapter5/chapter5.7",permalink:"/en/Modbus-projectOne/chapter5/chapter5.7",draft:!1,unlisted:!1,editUrl:"https://github.com/100askTeam/Modbus-TrainingDocs/tree/main/docs/Modbus-projectOne/chapter5/chapter5.7.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"modbustrainoneSidebar",previous:{title:"4.6 USBX \u7ec4\u4ef6",permalink:"/en/Modbus-projectOne/chapter5/chapter5.6"},next:{title:"4.8 \u865a\u62df\u4e32\u53e3\u6e90\u7801\u5206\u6790\u4e0e\u6539\u9020",permalink:"/en/Modbus-projectOne/chapter5/chapter5.8"}},_={},l=[{value:"4.7.1 \u914d\u7f6e USB",id:"471-\u914d\u7f6e-usb",level:3},{value:"4.7.2 \u6dfb\u52a0 USBX \u4ee3\u7801",id:"472-\u6dfb\u52a0-usbx-\u4ee3\u7801",level:3},{value:"1. \u590d\u5236\u4ee3\u7801",id:"1-\u590d\u5236\u4ee3\u7801",level:4},{value:"2. \u6dfb\u52a0\u8fdb\u5de5\u7a0b",id:"2-\u6dfb\u52a0\u8fdb\u5de5\u7a0b",level:4},{value:"4.7.3 \u6dfb\u52a0 USBX APP \u4ee3\u7801",id:"473-\u6dfb\u52a0-usbx-app-\u4ee3\u7801",level:3},{value:"4.7.4 \u4fee\u6539 usb.c",id:"474-\u4fee\u6539-usbc",level:3},{value:"4.7.5 \u521b\u5efa USBX \u4efb\u52a1",id:"475-\u521b\u5efa-usbx-\u4efb\u52a1",level:3},{value:"4.7.6 \u8bbe\u7f6e MDK-ARM \u5de5\u7a0b",id:"476-\u8bbe\u7f6e-mdk-arm-\u5de5\u7a0b",level:3},{value:"4.7.7 \u6dfb\u52a0\u4f7f\u7528\u4e32\u53e3\u7684\u4ee3\u7801",id:"477-\u6dfb\u52a0\u4f7f\u7528\u4e32\u53e3\u7684\u4ee3\u7801",level:3},{value:"4.7.8 \u4e0a\u673a\u5b9e\u9a8c",id:"478-\u4e0a\u673a\u5b9e\u9a8c",level:3}];function a(n){const e={a:"a",code:"code",h1:"h1",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.a)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h1,{id:"47-\u79fb\u690d-usbx-\u5b9e\u73b0\u865a\u62df\u4e32\u53e3",children:"4.7 \u79fb\u690d USBX \u5b9e\u73b0\u865a\u62df\u4e32\u53e3"}),"\n",(0,t.jsx)(e.p,{children:"\u672c\u8282\u7a0b\u5e8f\u6e90\u7801\u4e3a\u201c3_\u7a0b\u5e8f\u6e90\u780101_\u89c6\u9891\u914d\u5957\u7684\u6e90\u7801 4-7_\u79fb\u690d USBX \u5b9e\u73b0\u865a\u62df\u4e32\u53e3 uart_usb.7z\u201d\uff0c\u5728\u4e0a\u4e00\u8282\u4ee3\u7801 uart_rtos.7z \u7684\u57fa\u7840\u4e0a\u4fee\u6539\u5f97\u6765\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u79fb\u690d Controller layer\u3001stack layer\u3001Class layer \u5e76\u4e0d\u590d\u6742\uff0c \u91cd\u70b9\u5728\u4e8e 2 \u70b9\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u600e\u4e48\u521d\u59cb\u5316\u786c\u4ef6\u4ee5\u786e\u4fdd Controller layer \u53ef\u4ee5\u6b63\u5e38\u8fd0\u884c"}),"\n",(0,t.jsx)(e.li,{children:"\u600e\u4e48\u7f16\u5199 APP\uff1a\u63d0\u4f9b\u8bbe\u5907\u4fe1\u606f\u3001\u4f20\u8f93\u6570\u636e"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"471-\u914d\u7f6e-usb",children:"4.7.1 \u914d\u7f6e USB"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"http://photos.100ask.net/modbus-docs/project_one/chapter5/image61.png",alt:"img"})}),"\n",(0,t.jsx)(e.h3,{id:"472-\u6dfb\u52a0-usbx-\u4ee3\u7801",children:"4.7.2 \u6dfb\u52a0 USBX \u4ee3\u7801"}),"\n",(0,t.jsx)(e.h4,{id:"1-\u590d\u5236\u4ee3\u7801",children:"1. \u590d\u5236\u4ee3\u7801"}),"\n",(0,t.jsx)(e.p,{children:"\u627e\u5230\u56fa\u4ef6\u5e93\uff0c\u5982\u4e0b\uff1a"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"http://photos.100ask.net/modbus-docs/project_one/chapter5/image62.png",alt:"img"})}),"\n",(0,t.jsx)(e.p,{children:"\u628a usbx \u6574\u4e2a\u76ee\u5f55\u590d\u5236\u5230\u5de5\u7a0b\u201cMiddlewaresThird_Party\u201d\u76ee\u5f55\u4e0b\uff0c \u5982\u4e0b\uff1a"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"http://photos.100ask.net/modbus-docs/project_one/chapter5/image63.png",alt:"img"})}),"\n",(0,t.jsx)(e.h4,{id:"2-\u6dfb\u52a0\u8fdb\u5de5\u7a0b",children:"2. \u6dfb\u52a0\u8fdb\u5de5\u7a0b"}),"\n",(0,t.jsx)(e.p,{children:"\u9700\u8981\u6dfb\u52a0 USBX \u7684 3 \u5c42\u6e90\u7801\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5148\u4eff\u7167\u4e0b\u56fe\u6dfb\u52a0\u201cClass layer\u201d\u6e90\u7801\uff0c\u6dfb\u52a0\u542b\u6709\u201cux_device_class_cdc_acm \u201d\u524d\u7f00 \u7684 C \u6587\u4ef6\uff1a"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"http://photos.100ask.net/modbus-docs/project_one/chapter5/image64.png",alt:"img"})}),"\n",(0,t.jsx)(e.p,{children:"\u518d\u4eff\u7167\u4e0b\u56fe\u6dfb\u52a0\u201cstack layer\u201d\u6e90\u7801\uff0c\u53ef\u4ee5\u4ece\u6587\u4ef6\u540d\u7684\u524d\u9762\u770b\u51fa\u5b83\u4eec\u7684\u4f5c\u7528\uff0c \u6bd4\u5982 \u201c ux_device_stack \u201d\u8868\u793a\u8fd9\u662f stack \u6e90\u7801\uff0c\u201c ux_utility \u201d\u8868\u793a\u8fd9 \u662f \u8f85\u52a9 \u51fd\u6570 \uff0c \u201cux_system\u201d\u8868\u793a\u662f\u8fd9\u662f\u7cfb\u7edf\u51fd\u6570\uff1a"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"http://photos.100ask.net/modbus-docs/project_one/chapter5/image65.png",alt:"img"})}),"\n",(0,t.jsx)(e.p,{children:"\u6700\u540e\u4eff\u7167\u4e0b\u56fe\u6dfb\u52a0\u201cController layer\u201d\uff0c \u6dfb\u52a0\u201cux_dcd_stm32\u201d\u524d\u7f00\u7684 C \u6587\u4ef6\uff1a"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"http://photos.100ask.net/modbus-docs/project_one/chapter5/image66.png",alt:"img"})}),"\n",(0,t.jsx)(e.h3,{id:"473-\u6dfb\u52a0-usbx-app-\u4ee3\u7801",children:"4.7.3 \u6dfb\u52a0 USBX APP \u4ee3\u7801"}),"\n",(0,t.jsx)(e.p,{children:"\u53c2\u8003\u5de5\u7a0b\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["GIT \u4ed3\u5e93\uff1a",(0,t.jsx)(e.a,{href:"https://github.com/STMicroelectronics/STM32CubeH5.git",children:"https://github.com/STMicroelectronics/STM32CubeH5.git\uff0c"})]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u5de5\u7a0b\u8def\u5f84\uff1a"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-c",children:"STM32CubeH5\\Projects\\NUCLEO-H563ZI\\Applications\\USBX\\Ux_Device_HID_CDC_ACM\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u7f51\u76d8\u8d44\u6599\u4e2d\uff0c \u627e\u5230\u5982\u4e0b\u76ee\u5f55\uff1a"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"http://photos.100ask.net/modbus-docs/project_one/chapter5/image67.png",alt:"img"})}),"\n",(0,t.jsx)(e.p,{children:"\u628a app \u6587\u4ef6\u5939\u590d\u5236\u5230\u5de5\u7a0b\u7684\u201cMiddlewaresThird_Partyusbx\u201d\u76ee\u5f55\u4e0b\uff0c \u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"http://photos.100ask.net/modbus-docs/project_one/chapter5/image68.png",alt:"img"})}),"\n",(0,t.jsx)(e.p,{children:"\u5404\u4e2a\u6587\u4ef6\u7684\u4f5c\u7528\u4e3a\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"ux_user.h\uff1a\u914d\u7f6e USBX"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"ux_stm32_config.h\uff1a\u91cc\u9762\u542b\u6709\u914d\u7f6e\u9879\uff0c \u8868\u793a STM32 \u652f\u6301\u591a\u5c11\u4e2a endpoint"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"ux_device_descriptors.c/h\uff1aUSB \u865a\u62df\u4e32\u53e3\u7684\u63cf\u8ff0\u7b26\u4fe1\u606f"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"ux_device_cdc_acm.c\uff1aUSB \u4e32\u53e3\u7684 Activate/DeActivate \u51fd\u6570"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"app_usbx_device.c\uff1a\u8c03\u7528 stack layer \u51fd\u6570\uff0c \u6a21\u62df USB \u4e32\u53e3"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u5de5\u7a0b\u91cc\u6dfb\u52a0\u4e0a\u8ff0\u6587\u4ef6\uff0c \u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"http://photos.100ask.net/modbus-docs/project_one/chapter5/image69.png",alt:"img"})}),"\n",(0,t.jsx)(e.h3,{id:"474-\u4fee\u6539-usbc",children:"4.7.4 \u4fee\u6539 usb.c"}),"\n",(0,t.jsx)(e.p,{children:"\u4f7f\u7528 STM32CubeMX \u914d\u7f6e usb \u540e\u751f\u6210\u7684 usb.c \u91cc\uff0c\u53ea\u662f\u521d\u59cb\u5316\u4e86 USB \u63a7\u5236\u5668\uff0c\u5e76\u672a\u542f\u52a8 \u5b83\uff0c\u4e5f\u6ca1\u6709\u8ddf USBX \u5efa\u7acb\u8054\u7cfb\uff0c \u9700\u8981\u4fee\u6539\u4ee3\u7801\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u4ee3\u7801\u5982\u4e0b\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-c",children:'23 /* USER CODE BEGIN 0 */\n24 #include "ux_port.h"\n25 #include "ux_device_descriptors.h"\n26 #include "ux_dcd_stm32.h"\n27 /* USER CODE END 0 */\n/* \u7701\u7565 */\n33 void MX_USB_PCD_Init(void)\n34 {\n35\n36   /* USER CODE BEGIN USB_Init 0 */\n37   UINT MX_USBX_Device_Init(void);\n38   MX_USBX_Device_Init();\n39\n40   /* USER CODE END USB_Init 0 */\n41\n42   /* USER CODE BEGIN USB_Init 1 */\n43\n44   /* USER CODE END USB_Init 1 */\n45   hpcd_USB_DRD_FS.Instance = USB_DRD_FS;\n46   hpcd_USB_DRD_FS.Init.dev_endpoints = 8;\n47   hpcd_USB_DRD_FS.Init.speed = USBD_FS_SPEED;\n48   hpcd_USB_DRD_FS.Init.phy_itface = PCD_PHY_EMBEDDED;\n49   hpcd_USB_DRD_FS.Init.Sof_enable = DISABLE;\n50   hpcd_USB_DRD_FS.Init.low_power_enable = DISABLE;\n51   hpcd_USB_DRD_FS.Init.lpm_enable = DISABLE;\n52   hpcd_USB_DRD_FS.Init.battery_charging_enable = DISABLE;\n53   hpcd_USB_DRD_FS.Init.vbus_sensing_enable = DISABLE;\n54   hpcd_USB_DRD_FS.Init.bulk_doublebuffer_enable = DISABLE;\n55   hpcd_USB_DRD_FS.Init.iso_singlebuffer_enable = DISABLE;\n56   if (HAL_PCD_Init(&hpcd_USB_DRD_FS) != HAL_OK)\n57   {\n58     Error_Handler();\n59   }\n60   /* USER CODE BEGIN USB_Init 2 */\n61\n62   HAL_PWREx_EnableVddUSB();\n63   HAL_PWREx_EnableUSBVoltageDetector();\n64\n65   HAL_PCDEx_PMAConfig(&hpcd_USB_DRD_FS, 0x00, PCD_SNG_BUF, 0x14);\n66   HAL_PCDEx_PMAConfig(&hpcd_USB_DRD_FS, 0x80, PCD_SNG_BUF, 0x54);\n67   HAL_PCDEx_PMAConfig(&hpcd_USB_DRD_FS, USBD_CDCACM_EPINCMD_ADDR, PCD_SNG_BUF, 0x94); 68   HAL_PCDEx_PMAConfig(&hpcd_USB_DRD_FS, USBD_CDCACM_EPOUT_ADDR, PCD_SNG_BUF, 0xD4);\n69   HAL_PCDEx_PMAConfig(&hpcd_USB_DRD_FS, USBD_CDCACM_EPIN_ADDR, PCD_SNG_BUF, 0x114); 70   ux_dcd_stm32_initialize((ULONG)USB_DRD_FS, (ULONG)&hpcd_USB_DRD_FS);\n71\n72   HAL_PCD_Start(&hpcd_USB_DRD_FS);\n73\n74   /* USER CODE END USB_Init 2 */\n75 }\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c 38 \u884c\uff1a\u8c03\u7528 USBX \u7684\u51fd\u6570\uff0c \u6dfb\u52a0 USB \u4e32\u53e3\u7684\u652f\u6301\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c 62~63 \u884c\uff1a\u4f7f\u80fd USB \u63a7\u5236\u5668\u7684\u7535\u6e90\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c 65 69 \u884c\uff1a\u8bbe\u7f6e endpoint \u7684\u201cPacket Buffer Memory\u201d\uff0c\u8fd9\u4e2a\u6982\u5ff5\u53ef\u4ee5\u53c2\u8003\uff1a"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"http://www.51hei.com/bbs/dpj-40953-1.html",children:"http://www.51hei.com/bbs/dpj-40953-1.html\u3002"})}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c  70 \u884c \uff1a \u628a STM32  USB  \u63a7 \u5236 \u5668 \u7684 \u53e5 \u67c4 \uff0c \u4f20 \u7ed9 USBX \u7cfb \u7edf \uff0c"}),"\n",(0,t.jsx)(e.p,{children:"\u201cusbx_stm32_device_controllers\u201d\u7684\u4ee3\u7801\u4f1a\u4f7f\u7528\u8fd9\u4e2a\u53e5\u67c4\u6765\u64cd\u4f5c\u786c\u4ef6\u3002 \u7b2c 72 \u884c\uff1a\u542f\u52a8 USB \u63a7\u5236\u5668\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"475-\u521b\u5efa-usbx-\u4efb\u52a1",children:"4.7.5 \u521b\u5efa USBX \u4efb\u52a1"}),"\n",(0,t.jsx)(e.p,{children:"\u4f7f \u7528 \u5355 \u72ec \u6a21 \u5f0f \uff08STANDALONE \uff09 \u65f6 \uff0c \u9700 \u8981 \u521b \u5efa \u4e00 \u4e2a \u4efb \u52a1 \uff0c \u4e0d \u65ad \u8fd0 \u884c \u201c_ux_system_tasks_run \u201d\u51fd\u6570\u3002\u4ee5\u4e0b\u4ee3\u7801\u662f\u5728 FreeRTOS \u7684\u9ed8\u8ba4\u4efb\u52a1\u91cc\u8fd0\u884c\u548c\u8fd9\u4e2a\u51fd\u6570\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-c",children:'26 /* USER CODE BEGIN Includes */\n27 #include "stdio.h"\n28 #include "draw.h"\n29 #include "ux_api.h"\n30 /* USER CODE END Includes */\n/* \u7701\u7565 */\n195 /* USER CODE END Header_StartDefaultTask */\n196 void StartDefaultTask(void *argument)\n197 {\n198   /* USER CODE BEGIN defaultTask */\n\n199\t/* Infinite loop */\n200\tfor(;;)\n201\t{\n202     HAL_GPIO_WritePin(GPIOC, GPIO_PIN_12, GPIO_PIN_RESET);\n203     vTaskDelay(500);\n204\n205     HAL_GPIO_WritePin(GPIOC, GPIO_PIN_12, GPIO_PIN_SET);\n\n206\tvTaskDelay(500);\n207\tux_system_tasks_run();\n208\t}\n209   /* USER CODE END defaultTask */\n210 }\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c 29 \u884c\uff0c\u5305\u542b USBX \u7684\u5934\u6587\u4ef6\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c 207 \u884c\uff0c \u8c03\u7528 USBX \u7684\u7cfb\u7edf\u51fd\u6570\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"476-\u8bbe\u7f6e-mdk-arm-\u5de5\u7a0b",children:"4.7.6 \u8bbe\u7f6e MDK-ARM \u5de5\u7a0b"}),"\n",(0,t.jsx)(e.p,{children:"\u5982\u4e0b\u56fe\u914d\u7f6e\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u6dfb\u52a0\u5b8f\u5f00\u5173\uff1a UX_INCLUDE_USER_DEFINE_FILE\uff08\u56fe\u4e2d\u6807\u53f7 2\uff09"}),"\n",(0,t.jsx)(e.li,{children:"\u6dfb\u52a0\u5934\u6587\u4ef6\u76ee\u5f55\uff08\u56fe\u4e2d\u6807\u53f7 5\uff09"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"http://photos.100ask.net/modbus-docs/project_one/chapter5/image70.png",alt:"img"})}),"\n",(0,t.jsx)(e.h3,{id:"477-\u6dfb\u52a0\u4f7f\u7528\u4e32\u53e3\u7684\u4ee3\u7801",children:"4.7.7 \u6dfb\u52a0\u4f7f\u7528\u4e32\u53e3\u7684\u4ee3\u7801"}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u201cCoreSrcapp_freertos.c\u201d\u91cc\u6dfb\u52a0 USB \u4e32\u53e3\u7684\u53d1\u9001\u6d4b\u8bd5\u4ee3\u7801\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-c",children:'26 /* USER CODE BEGIN Includes */\n27 #include "stdio.h"\n28 #include "draw.h"\n29 #include "ux_api.h"\n30 /* USER CODE END Includes */\n/* \u7701\u7565 */\n69 static void SPILCDTaskFunction( void *pvParameters )\n70 {\n71      char buf[100];\n72      int cnt = 0;\n73\n74      while (1)\n75      {\n76         sprintf(buf, "USB Serial Send Test : %d\\r\\n", cnt++);\n77         //Draw_String(0, 0, buf, 0x0000ff00, 0);\n78\n79         int ux_device_cdc_acm_send(uint8_t *datas, uint32_t len, uint32_t timeout);\n80         ux_device_cdc_acm_send((uint8_t *)buf, strlen(buf), 1000);\n81         vTaskDelay(1000);\n82      }\n83 }\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c 29 \u884c\uff1a\u5305\u542b\u5934\u6587\u4ef6\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c 79~80 \u884c\uff1a\u4f7f\u7528 USB \u4e32\u53e3\u53d1\u9001\u6570\u636e\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u201cMiddlewaresThird_Partyusbxappux_device_cdc_acm.c\u201d\u4e2d\uff0c\u6709\u5982\u4e0b\u4ee3\u7801\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-c",children:"111 static UINT ux_device_class_cdc_acm_read_callback(struct UX_SLAVE_CLASS_CDC_ACM_STRUCT *cdc_acm, UINT status, UCHAR *data_pointer, ULONG length)\n112 {\n113     int Draw_String(uint32_t x, uint32_t y, char *str, uint32_t front_color, uint32_t\nback_color);\n114     if (status == UX_SUCCESS)\n115     {\n116         data_pointer[length] = '\\0';\n117         Draw_String(0, 0, (char *)data_pointer, 0x0000ff00, 0);\n118     }\n119         return 0;\n120 }\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5f53 USB \u4e32\u53e3\u6536\u5230\u6570\u636e\u540e\uff0c ux_device_class_cdc_acm_read_callback \u51fd\u6570\u88ab\u8c03\u7528\u3002 \u7b2c 117 \u884c\u628a\u63a5\u6536\u5230\u7684\u6570\u636e\u5728 LCD \u4e0a\u663e\u793a\u5904\u6765\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"478-\u4e0a\u673a\u5b9e\u9a8c",children:"4.7.8 \u4e0a\u673a\u5b9e\u9a8c"}),"\n",(0,t.jsx)(e.p,{children:"\u70e7\u5199\u8fd0\u884c\u7a0b\u5e8f\u540e\uff0c\u63a5\u4e0a USB \u7ebf\uff0c\u5728\u7535\u8111\u4e0a\u53ef\u4ee5\u8bc6\u522b\u51fa USB \u4e32\u53e3\uff0c\u67e5\u770b\u8bbe\u5907\u7ba1\u7406\u5668\uff0c\u53ef \u4ee5\u770b\u5230\u5982\u4e0b\u8bbe\u5907\uff1a"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"http://photos.100ask.net/modbus-docs/project_one/chapter5/image71.png",alt:"img"})}),"\n",(0,t.jsx)(e.p,{children:"\u4f7f\u7528\u4e32\u53e3\u5de5\u5177\u6253\u5f00\u8fd9\u4e2a\u4e32\u53e3\uff0c \u53ef\u4ee5\u8fde\u7eed\u4e0d\u65ad\u63a5\u6536\u5230\u6570\u636e\uff0c\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:"http://photos.100ask.net/modbus-docs/project_one/chapter5/image72.png",alt:"img"})}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u4e32\u53e3\u5de5\u5177\u4e0a\u53d1\u9001\u6570\u636e\u65f6\uff0c\u5728\u677f\u5b50\u7684 LCD \u4e0a\u4f1a\u6709\u663e\u793a\u3002"})]})}function p(n={}){const{wrapper:e}={...(0,c.a)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(a,{...n})}):a(n)}},1151:(n,e,s)=>{s.d(e,{Z:()=>d,a:()=>r});var t=s(7294);const c={},i=t.createContext(c);function r(n){const e=t.useContext(i);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:r(n.components),t.createElement(i.Provider,{value:e},n.children)}}}]);